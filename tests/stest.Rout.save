
R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> 
> library(exactRankTests)
> 
> RNGkind("Wichmann-Hill", "Kinderman-Ramage")
> set.seed(29081975)
> 
> # test the distribution functions
> 
> # paired observations
> 
> hansi <- c()
> seppl <- c()
> for (i in 1:10)
+ {
+ 	m <- sample(10:50, 1)
+ 	score <- sample(m)
+ 	val <- sample(0:m, 1)
+ 	# cat("m: ", m, "n: ", n, " val: ", val, "\n")
+ 	hansi <- c(hansi,  psignrank(val, m))
+ 	cat("psignrank: ", hansi[length(hansi)])
+ 	seppl <- c(seppl, pperm(val, score, m, alternative="less",
+                                 simulate=TRUE, B=20000))
+ 	cat(" pperm: ", seppl[length(seppl)], "\n")
+ }
psignrank:  1.525879e-05 pperm:  0 
psignrank:  2.011802e-08 pperm:  0 
psignrank:  2.876277e-11 pperm:  0 
psignrank:  3.808509e-12 pperm:  0 
psignrank:  0.04199219 pperm:  0.04155 
psignrank:  1.018634e-10 pperm:  0 
psignrank:  6.103516e-05 pperm:  5e-05 
psignrank:  1.204899e-08 pperm:  0 
psignrank:  7.105427e-15 pperm:  0 
psignrank:  3.919922e-09 pperm:  0 
> 
> cat("Max difference: ", max(abs(hansi - seppl)), "\n")
Max difference:  0.0004421875 
> 
> #  stopifnot(max(abs(hansi - seppl)) <= 1e-10)
> 
> hansi <- c()
> seppl <- c()
> for (i in 1:10)
+ {
+         m <- sample(10:50, 1)
+         score <- sample(m)
+         prob <- runif(1)
+         # cat("m: ", m, "n: ", n, " prob: ", prob, "\n")
+         hansi <- c(hansi,  qsignrank(prob, m))
+         cat("qwilcox: ", hansi[length(hansi)])
+         seppl <- c(seppl, qperm(prob, score, m, 
+                           simulate=TRUE, B=20000))
+         cat(" qperm: ", seppl[length(seppl)], "\n")
+ }
qwilcox:  385 qperm:  387 
qwilcox:  91 qperm:  91 
qwilcox:  403 qperm:  402 
qwilcox:  74 qperm:  74 
qwilcox:  127 qperm:  127 
qwilcox:  78 qperm:  78 
qwilcox:  49 qperm:  49 
qwilcox:  563 qperm:  563 
qwilcox:  531 qperm:  531 
qwilcox:  30 qperm:  29 
> 
> cat("Max difference: ", max(abs(hansi - seppl)), "\n")
Max difference:  2 
> 
> #  stopifnot(max(abs(hansi - seppl)) <= 1e-10)
> 
> # independent observations
> 
> hansi <- c()
> seppl <- c()
> for (i in 1:10)
+ {
+ 	m <- sample(10:50, 1)
+ 	if (runif(1) < 0.5)
+ 		n <- sample(10:50, 1)
+ 	else	
+ 		n <- m
+ 	score <- sample(n+m)
+ 	val <- sample(0:(m*n), 1)
+ 	# cat("m: ", m, "n: ", n, " val: ", val, "\n")
+ 	hansi <- c(hansi,  pwilcox(val, m, n))
+ 	cat("pwilcox: ", hansi[length(hansi)])
+ 	seppl <- c(seppl, pperm(val + m*(m+1)/2, score, m,
+                           alternative="less", 
+                           simulate=TRUE, B=20000))
+ 	cat(" pperm: ", seppl[length(seppl)], "\n")
+ }
pwilcox:  0.9996932 pperm:  0.99975 
pwilcox:  0.6243931 pperm:  0.62845 
pwilcox:  0.1810789 pperm:  0.18185 
pwilcox:  0.06168415 pperm:  0.062 
pwilcox:  0.9768032 pperm:  0.97785 
pwilcox:  5.782206e-08 pperm:  0 
pwilcox:  1 pperm:  1 
pwilcox:  4.000916e-14 pperm:  0 
pwilcox:  0.06254613 pperm:  0.0628 
pwilcox:  0.8662089 pperm:  0.8663 
> 
> cat("Max difference: ", max(abs(hansi - seppl)), "\n")
Max difference:  0.004056908 
> 
> #  stopifnot(max(abs(hansi - seppl)) <= 1e-10) 
> 
> hansi <- c()
> seppl <- c()
> for (i in 1:10)
+ {
+         m <- sample(10:50, 1)
+         if (runif(1) < 0.5)
+                 n <- sample(10:50, 1)
+         else
+                 n <- m
+         score <- sample(n+m)
+         prob <- runif(1)
+         # cat("m: ", m, "n: ", n, " prob: ", prob, "\n")
+         hansi <- c(hansi,  qwilcox(prob, m, n))
+         cat("qwilcox: ", hansi[length(hansi)])
+         seppl <- c(seppl, qperm(prob, score, m, simulate=TRUE, B=20000) 
+                           - m*(m+1)/2)
+         cat(" qperm: ", seppl[length(seppl)], "\n")
+ }
qwilcox:  782 qperm:  781 
qwilcox:  336 qperm:  337 
qwilcox:  275 qperm:  275 
qwilcox:  996 qperm:  996 
qwilcox:  269 qperm:  269 
qwilcox:  268 qperm:  268 
qwilcox:  420 qperm:  421 
qwilcox:  950 qperm:  951 
qwilcox:  274 qperm:  274 
qwilcox:  115 qperm:  115 
> 
> cat("Max difference: ", max(abs(hansi - seppl)), "\n")
Max difference:  1 
> 
> #  stopifnot(max(abs(hansi - seppl)) <= 1e-10) 
> 
> 
